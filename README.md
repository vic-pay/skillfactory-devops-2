# Репозиторий для практикума по автоматизации курса Skillfactory: DevOps

# Задание
https://github.com/SkillfactoryCodingTeam/devops__project__automation

# Решение
С помощью playbook.yml Ansible:
- устанавливаюится необходимые пакеты
- создаются директории /opt/sync-mirror для хранения конфигурационных файлов и /opt/sync-mirror/html для хранения зеркала
- копируется Makefile в котором описан процесс получения .html файлов и процесс управления docker образамии и контейнером. 
- копируется Dockerfile в котором описан процесс сборки Docker image с nginx и .html файлами
- создается задание в /etc/crontab
- далее cron вызывает make sync && make deploy для получения .html файлов и пересборки контейнера

# Установка
Установка выполняется на локальный компьютер с помощью Ansible 
- установить Ansible командой sudo apt install ansible
- скопировать содержимое репозитория в каталог
- перейти в каталог и выполнить ./run.sh
- ввести пароль sudo 

# Проверка
Задания можно выполнить вручную:

*make -f /opt/sync-mirror/Makefile sync* получения .html файлов 

*make -f /opt/sync-mirror/Makefile deploy* для пересборки и запуска контейнера

Для удобства при сборке используется прямой вызов bash, весь вывод должен быть отформатирован правильно
Получить доступ к статьям можно перейдя в браузере по адресу:

*127.0.0.1/bugs.html*

# Важные моменты
При остановке и удалении контейнеров используется конструкция типа [команда];:; 
Это необходимо, чтобы make продолжал работу, если в этих командах будет ошибка.
Например, если команды запускаются первый раз, то контейнера не будет, останавливать нечего и нужно переходить к следующим шагам
